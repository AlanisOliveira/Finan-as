<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Financeiro Avançado</title>
    <link rel="stylesheet" href="style.css?v=202508">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- HEADER -->
    <header class="header">
        <div class="header-content">
            <div class="logo">< Alanis Finanças /> </div>
            
            <div class="year-selector">
                <label>Ano:</label>
                <button class="year-btn" data-year="2025">2025</button>
                <button class="year-btn" data-year="2026">2026</button>
                <button class="year-btn" data-year="2027">2027</button>
            </div>

            <div class="header-tools">
                <button class="btn btn-secondary btn-small" id="loadDataBtn" onclick="app.promptForUserId('load')">
                    📥 Carregar Dados
                </button>
                <button class="btn btn-secondary btn-small" id="saveDataBtn" onclick="app.saveDataToFirestore()">
                    💾 Salvar Dados
                </button>
                <button class="btn btn-secondary btn-small" id="generateAndSaveNewIdBtn" onclick="app.generateAndSaveNewId()">
                    ✨ Gerar Novo ID e Salvar
                </button>
                <button class="btn btn-secondary btn-small" onclick="app.showCurrentUserId()">
                    👁️ Visualizar ID
                </button>
                <button class="btn btn-secondary btn-small" onclick="app.openSettings()">
                    ⚙️ Config
                </button>
            </div>
        </div>
    </header>

    <!-- MONTH TABS -->
    <div class="month-tabs-container">
        <div class="month-tabs" id="monthTabs">
            <button class="month-tab active" data-month="0">Janeiro</button>
            <button class="month-tab" data-month="1">Fevereiro</button>
            <button class="month-tab" data-month="2">Março</button>
            <button class="month-tab" data-month="3">Abril</button>
            <button class="month-tab" data-month="4">Maio</button>
            <button class="month-tab" data-month="5">Junho</button>
            <button class="month-tab" data-month="6">Julho</button>
            <button class="month-tab" data-month="7">Agosto</button>
            <button class="month-tab" data-month="8">Setembro</button>
            <button class="month-tab" data-month="9">Outubro</button>
            <button class="month-tab" data-month="10">Novembro</button>
            <button class="month-tab" data-month="11">Dezembro</button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="left-panel">
            <!-- DASHBOARD -->
            <div class="dashboard">
                <div class="dashboard-card entradas">
                    <div class="dashboard-title">💰 Entradas</div>
                    <div class="dashboard-value entradas" id="totalEntradas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Receitas do período</div>
                </div>
                <div class="dashboard-card saidas">
                    <div class="dashboard-title">📉 Saídas</div>
                    <div class="dashboard-value saidas" id="totalSaidas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Gastos do período</div>
                </div>
                <div class="dashboard-card">
                    <div class="dashboard-title">📊 Saldo</div>
                    <div class="dashboard-value saldo" id="saldoTotal">R$ 0,00</div>
                    <div class="dashboard-subtitle">Resultado líquido</div>
                </div>
                <div class="dashboard-card dividas">
                    <div class="dashboard-title">🤝 Dívidas</div>
                    <div class="dashboard-value dividas" id="totalDividas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Valores em aberto</div>
                </div>
            </div>

            <!-- ADVANCED DASHBOARD -->
            <div class="dashboard-advanced">
                <div class="dashboard-card metas">
                    <div class="dashboard-title">🎯 Metas do Mês</div>
                    <div class="dashboard-value" id="metaProgress">0%</div>
                    <div class="dashboard-subtitle" id="metaSubtitle">Sem metas definidas</div>
                </div>
                <div class="dashboard-card comparativo">
                    <div class="dashboard-title">📈 Comparativo (Mês)</div>
                    <div class="dashboard-value" id="comparativoValue">-</div>
                    <div class="dashboard-subtitle" id="comparativoSubtitle">Mês anterior sem dados</div>
                </div>
            </div>

            <!-- CARD DASHBOARD -->
            <div class="section" id="cardDashboardSection">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="section-title mb-0">💳 Meus Cartões</h2>
                    <button class="btn btn-secondary" onclick="app.openCardModal()">Gerenciar Cartões</button>
                </div>
                <div class="dashboard" id="cardDashboard"></div>
            </div>

            <!-- LOANS SECTION -->
            <div class="section" id="loansSection">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="section-title mb-0">🏦 Meus Empréstimos</h2>
                    <button class="btn btn-secondary" onclick="app.openLoanModal()">Adicionar Empréstimo</button>
                </div>
                <div id="loanList">
                    <p class="text-muted" style="text-align: center; padding: 20px 0;">Nenhum empréstimo registrado.</p>
                </div>
            </div>

            <!-- FORM SECTION -->
            <div class="section">
                <h2 class="section-title">➕ Nova Transação</h2>
                <form id="transactionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="data">📅 Data</label>
                            <input type="date" id="data" name="data" required>
                            <div class="error-message" id="dataError">Data inválida</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="tipo">📊 Tipo</label>
                            <select id="tipo" name="tipo" required>
                                <option value="">Selecione...</option>
                                <option value="Entrada">💰 Entrada</option>
                                <option value="Saída">📉 Saída</option>
                            </select>
                            <div class="error-message" id="tipoError">Tipo é obrigatório</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="descricao">📝 Descrição</label>
                            <input type="text" id="descricao" name="descricao" placeholder="Ex: Salário, Compras no mercado..." required>
                            <div class="error-message" id="descricaoError">Descrição é obrigatória</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="categoria">🏷️ Categoria</label>
                            <div class="custom-select-container">
                                <select id="categoria" name="categoria" required>
                                    <option value="">Selecione...</option>
                                </select>
                                <button type="button" class="add-option-btn" onclick="app.addCustomOption('categoria')">+</button>
                            </div>
                            <div class="error-message" id="categoriaError">Categoria é obrigatória</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="banco">🏦 Banco/Conta</label>
                            <div class="custom-select-container">
                                <select id="banco" name="banco" required>
                                    <option value="">Selecione...</option>
                                </select>
                                <button type="button" class="add-option-btn" onclick="app.addCustomOption('banco')">+</button>
                            </div>
                            <div class="error-message" id="bancoError">Banco é obrigatório</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="valor">💵 Valor Total</label>
                            <input type="number" id="valor" name="valor" step="0.01" min="0.01" placeholder="0,00" required>
                            <div class="error-message" id="valorError">Valor deve ser maior que zero</div>
                        </div>
                        
                        <div class="form-group hidden" id="valorPagoGroup">
                            <label for="valorPago">💳 Valor Pago por Mim</label>
                            <input type="number" id="valorPago" name="valorPago" step="0.01" min="0" placeholder="0,00">
                            <div class="error-message" id="valorPagoError">Valor pago inválido</div>
                        </div>
                        
                        <div class="form-group" id="gastoParaGroup">
                            <label for="gastoPara">👤 Gasto para (opcional)</label>
                            <select id="gastoPara" name="gastoPara">
                                <option value="">Gasto pessoal</option>
                            </select>
                            <div style="margin-top: 5px;">
                                <button type="button" class="btn btn-secondary btn-small" onclick="app.addPersonFromGasto()">
                                    ➕ Nova Pessoa
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="formaPagamento">💳 Forma de Pagamento</label>
                            <select id="formaPagamento" name="formaPagamento" required>
                                <option value="">Selecione...</option>
                                <option value="PIX">🔄 PIX</option>
                                <option value="Débito">💳 Débito</option>
                                <option value="Crédito">💎 Crédito</option>
                                <option value="Dinheiro">💵 Dinheiro</option>
                                <option value="TED/DOC">🏦 TED/DOC</option>
                            </select>
                            <div class="error-message" id="formaPagamentoError">Forma de pagamento é obrigatória</div>
                        </div>

                        <div class="form-group hidden" id="cardSelectGroup">
                            <label for="cardSelect">💳 Cartão de Crédito</label>
                            <select id="cardSelect" name="cardSelect">
                                <option value="">Selecione o cartão...</option>
                            </select>
                            <div class="error-message" id="cardSelectError">Selecione um cartão</div>
                        </div>

                        <div class="form-group hidden" id="installmentsGroup">
                            <label for="installments">Nº de Parcelas</label>
                            <input type="number" id="installments" name="installments" min="1" value="1">
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="observacao">📄 Observações</label>
                            <textarea id="observacao" name="observacao" rows="2" placeholder="Informações adicionais..."></textarea>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="compartilhada" name="compartilhada">
                        <label for="compartilhada">🤝 Dividir este gasto com outras pessoas</label>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary">
                            ➕ Adicionar Transação
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="app.clearForm()">
                            🔄 Limpar
                        </button>
                    </div>
                </form>
            </div>

            <!-- TRANSACTIONS TABLE -->
            <div class="transactions-section">
                <div class="table-header">
                    <h2 class="section-title">📋 Histórico de Transações</h2>
                    
                    <div class="search-container">
                        <span class="search-icon">🔍</span>
                        <input type="text" class="search-input" id="searchInput" placeholder="Buscar por descrição, valor ou observações...">
                    </div>
                    
                    <div class="table-filters">
                        <div class="filter-group">
                            <label>Tipo:</label>
                            <select id="filterTipo">
                                <option value="">Todos</option>
                                <option value="Entrada">Entradas</option>
                                <option value="Saída">Saídas</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Categoria:</label>
                            <select id="filterCategoria">
                                <option value="">Todas</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Banco:</label>
                            <select id="filterBanco">
                                <option value="">Todos</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Status:</label>
                            <select id="filterStatus">
                                <option value="">Todos</option>
                                <option value="compartilhada">Compartilhadas</option>
                                <option value="individual">Individuais</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="data">📅 Data</th>
                                <th class="sortable" data-sort="descricao">📝 Descrição</th>
                                <th class="sortable" data-sort="tipo">📊 Tipo</th>
                                <th class="sortable" data-sort="valor">💵 Valor</th>
                                <th class="sortable" data-sort="valorPago">💳 Pago</th>
                                <th class="sortable" data-sort="categoria">🏷️ Categoria</th>
                                <th class="sortable" data-sort="banco">🏦 Banco</th>
                                <th>🤝 Status</th>
                                <th>⚙️ Ações</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsBody">
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                                    Nenhuma transação encontrada
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- Paginação será inserida dinamicamente -->
                </div>
            </div>

            <!-- ANALYSIS SECTION -->
            <div class="section">
                <h2 class="section-title">📊 Análises do Mês</h2>
                <div class="analysis-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                    <div id="cardSummarySection">
                        <h3 class="section-title">Resumo dos Cartões</h3>
                        <!-- Card summary will be injected here -->
                    </div>
                    <div id="categoryChartSection">
                        <h3 class="section-title">Gastos por Categoria</h3>
                        <!-- Pie chart will be injected here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel">
            <!-- DEBT PANEL -->
            <div class="debt-panel">
                <div class="debt-panel-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>🤝 Dívidas e Contas</span>
                    <button class="btn btn-small btn-primary" style="background-color: white; color: var(--warning);" onclick="app.openDebtManagementModal()">Adicionar</button>
                </div>
                <div id="accountsReceivableSection">
                    <h4 style="padding: 10px 15px; background: var(--bg-secondary);">Contas a Receber</h4>
                    <div class="debt-list" id="receivableList">
                        <p class="text-muted" style="padding: 15px; text-align: center;">Ninguém te deve.</p>
                    </div>
                </div>
                <div id="accountsPayableSection">
                    <h4 style="padding: 10px 15px; background: var(--bg-secondary);">Contas a Pagar</h4>
                    <div class="debt-list" id="payableList">
                        <p class="text-muted" style="padding: 15px; text-align: center;">Você não deve a ninguém.</p>
                    </div>
                </div>
            </div>

            <!-- QUICK STATS -->
            <div class="section">
                <h3 class="section-title">📊 Estatísticas Rápidas</h3>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span>Transações este mês:</span>
                        <strong id="statsTransacoes">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Gastos compartilhados:</span>
                        <strong id="statsCompartilhados">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Pessoas envolvidas:</span>
                        <strong id="statsPessoas">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Maior gasto:</span>
                        <strong id="statsMaiorGasto">R$ 0,00</strong>
                    </div>
                </div>
            </div>

            <!-- GASTOS POR PESSOA -->
            <div class="section">
                <h3 class="section-title">👤 Gastos por Pessoa</h3>
                <div id="gastosPorPessoa">
                    <p class="text-muted">Nenhum gasto para outras pessoas</p>
                </div>
            </div>

            <!-- GOALS/METAS SYSTEM -->
            <div class="section">
                <h3 class="section-title">🎯 Sistema de Metas</h3>
                
                <!-- Goals Form -->
                <div class="goals-form-container" style="margin-bottom: 20px;">
                    <form id="goalsForm" class="form-inline">
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaNome">Nome da Meta</label>
                            <input type="text" id="metaNome" placeholder="Ex: Emergência, Viagem" required>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaBanco">Banco/Conta</label>
                            <select id="metaBanco" required>
                                <option value="">Selecione o banco</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaValorDesejado">Valor Desejado</label>
                            <input type="number" id="metaValorDesejado" step="0.01" min="0" required>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaValorAtual">Valor Atual</label>
                            <input type="number" id="metaValorAtual" step="0.01" min="0" value="0">
                        </div>
                        
                        <button type="submit" class="btn btn-primary">➕ Adicionar Meta</button>
                    </form>
                </div>
                
                <!-- Active Goals List -->
                <div id="activeGoals">
                    <p class="text-muted">Nenhuma meta definida</p>
                </div>
            </div>

            <!-- RECENT PEOPLE -->
            <div class="section">
                <h3 class="section-title">👥 Pessoas Recentes</h3>
                <div id="recentPeople">
                    <p class="text-muted">Nenhuma pessoa cadastrada</p>
                </div>
            </div>
        </div>
    </main>

    <!-- MODALS -->
    
    <!-- SPLIT MODAL -->
    <div class="modal-overlay" id="splitModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">🤝 Dividir Gasto</h3>
                <button class="modal-close" onclick="app.closeSplitModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="split-type-selector">
                    <button type="button" class="split-type-btn active" data-type="igual">
                        📊 Divisão Igual
                    </button>
                    <button type="button" class="split-type-btn" data-type="percentual">
                        📈 Por Percentual
                    </button>
                    <button type="button" class="split-type-btn" data-type="fixo">
                        💰 Valores Fixos
                    </button>
                </div>

                <div class="form-group">
                    <label for="splitPersonSelect">👥 Adicionar Pessoa:</label>
                    <div style="display: flex; gap: 10px;">
                        <select id="splitPersonSelect" style="flex: 1;"></select>
                        <button type="button" class="btn btn-secondary" onclick="app.addPersonToSplit()">
                            ➕ Adicionar
                        </button>
                    </div>
                </div>

                <div class="people-list" id="splitPeopleList">
                    <!-- Pessoas serão adicionadas dinamicamente -->
                </div>

                <div class="form-group">
                    <div style="display: flex; justify-content: space-between; font-weight: 600;">
                        <span>Total a dividir:</span>
                        <span id="splitTotalValue">R$ 0,00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeSplitModal()">
                    ❌ Cancelar
                </button>
                <button class="btn btn-primary" onclick="app.saveSplitTransaction()">
                    ✅ Salvar Divisão
                </button>
            </div>
        </div>
    </div>

    <!-- DEBT DETAIL MODAL -->
    <div class="modal-overlay" id="debtModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="debtModalTitle">👤 Detalhes da Dívida</h3>
                <button class="modal-close" onclick="app.closeDebtModal()">&times;</button>
            </div>
            <div class="modal-body" id="debtModalBody">
                <!-- Conteúdo será carregado dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeDebtModal()">
                    ❌ Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- CARD MANAGEMENT MODAL -->
    <div class="modal-overlay" id="cardModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="cardModalTitle">💳 Gerenciar Cartões</h3>
                <button class="modal-close" onclick="app.closeCardModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cardSummaryInModal" style="margin-bottom: 20px;"></div>
                <form id="cardForm">
                    <input type="hidden" id="cardId">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="cardName">Nome do Cartão</label>
                            <input type="text" id="cardName" placeholder="Ex: Nubank Ultravioleta" required>
                        </div>
                        <div class="form-group">
                            <label for="cardLimit">Limite Total (R$)</label>
                            <input type="number" id="cardLimit" step="0.01" min="0" placeholder="5000,00" required>
                        </div>
                        <div class="form-group">
                            <label for="cardBrand">Bandeira</label>
                            <select id="cardBrand" required>
                                <option value="Mastercard">Mastercard</option>
                                <option value="Visa">Visa</option>
                                <option value="Elo">Elo</option>
                                <option value="American Express">American Express</option>
                                <option value="Hipercard">Hipercard</option>
                                <option value="Outra">Outra</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cardClosingDay">Dia do Fechamento</label>
                            <input type="number" id="cardClosingDay" min="1" max="31" placeholder="Ex: 25" required>
                        </div>
                        <div class="form-group">
                            <label for="cardDueDay">Dia do Vencimento</label>
                            <input type="number" id="cardDueDay" min="1" max="31" placeholder="Ex: 10" required>
                        </div>
                        <div class="form-group">
                            <label for="cardColor">Cor do Cartão</label>
                            <input type="color" id="cardColor" value="#8A2BE2" style="padding: 5px; height: 45px;">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeCardModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Cartão</button>
                    </div>
                </form>
                <hr class="mb-2 mt-2">
                <h4 class="section-title">Cartões Cadastrados</h4>
                <div id="cardList"></div>
            </div>
        </div>
    </div>

    <!-- LOAN MANAGEMENT MODAL -->
    <div class="modal-overlay" id="loanModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="loanModalTitle">Adicionar Empréstimo</h3>
                <button class="modal-close" onclick="app.closeLoanModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loanForm">
                    <input type="hidden" id="loanId">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="loanDescription">Descrição do Empréstimo</label>
                            <input type="text" id="loanDescription" placeholder="Ex: Financiamento Carro, Empréstimo Pessoal" required>
                        </div>
                        <div class="form-group">
                            <label for="loanTotalAmount">Valor Total (R$)</label>
                            <input type="number" id="loanTotalAmount" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="loanAmountPaid">Valor já Pago (R$)</label>
                            <input type="number" id="loanAmountPaid" step="0.01" min="0" value="0" required>
                        </div>
                        <div class="form-group">
                            <label for="loanInstallmentAmount">Valor da Parcela (R$)</label>
                            <input type="number" id="loanInstallmentAmount" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="loanNextDueDate">Próximo Vencimento</label>
                            <input type="date" id="loanNextDueDate">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeLoanModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Empréstimo</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- DEBT MANAGEMENT MODAL -->
    <div class="modal-overlay" id="debtManagementModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Gerenciar Dívida</h3>
                <button class="modal-close" onclick="app.closeDebtManagementModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="debtForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="debtType">Tipo de Dívida</label>
                            <select id="debtType" required>
                                <option value="aPagar">Eu devo (Conta a Pagar)</option>
                                <option value="aReceber">Me devem (Conta a Receber)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="debtPerson">Pessoa</label>
                            <select id="debtPerson" required></select>
                        </div>
                        <div class="form-group full-width">
                            <label for="debtDescription">Descrição</label>
                            <input type="text" id="debtDescription" placeholder="Ex: Aluguel, Empréstimo amigo" required>
                        </div>
                        <div class="form-group">
                            <label for="debtAmount">Valor (R$)</label>
                            <input type="number" id="debtAmount" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="debtDueDate">Data de Vencimento</label>
                            <input type="date" id="debtDueDate" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeDebtManagementModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Dívida</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- INVOICE DETAIL MODAL -->
    <div class="modal-overlay" id="invoiceDetailModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title" id="invoiceDetailTitle">Detalhes da Fatura</h3>
                <button class="modal-close" onclick="app.closeInvoiceDetailModal()">&times;</button>
            </div>
            <div class="modal-body" id="invoiceDetailBody">
                <!-- Content will be loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeInvoiceDetailModal()">Fechar</button>
                <button class="btn btn-success" id="payInvoiceBtn">Pagar Fatura</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">⚙️ Configurações</h3>
                <button class="modal-close" onclick="app.closeSettings()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>🏷️ Categorias Personalizadas:</label>
                    <div id="customCategories"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addCustomCategory()">
                        ➕ Nova Categoria
                    </button>
                </div>

                <div class="form-group">
                    <label>🏦 Bancos/Contas Personalizadas:</label>
                    <div id="customBanks"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addCustomBank()">
                        ➕ Novo Banco
                    </button>
                </div>

                <div class="form-group">
                    <label>👥 Pessoas Cadastradas:</label>
                    <div id="peopleList"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addPerson()">
                        ➕ Nova Pessoa
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="app.clearAllData()">
                    🗑️ Limpar Tudo
                </button>
                <button class="btn btn-secondary" onclick="app.closeSettings()">
                    ❌ Fechar
                </button>
            </div>
        </div>
    </div>

    <script src="script.js?v=202508"></script>
</body>
</html>