<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Financeiro Avan√ßado</title>
    <link rel="stylesheet" href="style.css?v=202508">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- HEADER -->
    <header class="header">
        <div class="header-content">
            <div class="logo">< Alanis Finan√ßas /> </div>
            
            <div class="year-selector">
                <label>Ano:</label>
                <button class="year-btn" data-year="2025">2025</button>
                <button class="year-btn" data-year="2026">2026</button>
                <button class="year-btn" data-year="2027">2027</button>
            </div>

            <div class="header-tools">
                <button class="btn btn-secondary btn-small" id="loadDataBtn" onclick="app.promptForUserId('load')">
                    üì• Carregar Dados
                </button>
                <button class="btn btn-secondary btn-small" id="saveDataBtn" onclick="app.saveDataToFirestore()">
                    üíæ Salvar Dados
                </button>
                <button class="btn btn-secondary btn-small" id="generateAndSaveNewIdBtn" onclick="app.generateAndSaveNewId()">
                    ‚ú® Gerar Novo ID e Salvar
                </button>
                <button class="btn btn-secondary btn-small" onclick="app.showCurrentUserId()">
                    üëÅÔ∏è Visualizar ID
                </button>
                <button class="btn btn-secondary btn-small" onclick="app.openSettings()">
                    ‚öôÔ∏è Config
                </button>
            </div>
        </div>
    </header>

    <!-- MONTH TABS -->
    <div class="month-tabs-container">
        <div class="month-tabs" id="monthTabs">
            <button class="month-tab active" data-month="0">Janeiro</button>
            <button class="month-tab" data-month="1">Fevereiro</button>
            <button class="month-tab" data-month="2">Mar√ßo</button>
            <button class="month-tab" data-month="3">Abril</button>
            <button class="month-tab" data-month="4">Maio</button>
            <button class="month-tab" data-month="5">Junho</button>
            <button class="month-tab" data-month="6">Julho</button>
            <button class="month-tab" data-month="7">Agosto</button>
            <button class="month-tab" data-month="8">Setembro</button>
            <button class="month-tab" data-month="9">Outubro</button>
            <button class="month-tab" data-month="10">Novembro</button>
            <button class="month-tab" data-month="11">Dezembro</button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="left-panel">
            <!-- DASHBOARD -->
            <div class="dashboard">
                <div class="dashboard-card entradas">
                    <div class="dashboard-title">üí∞ Entradas</div>
                    <div class="dashboard-value entradas" id="totalEntradas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Receitas do per√≠odo</div>
                </div>
                <div class="dashboard-card saidas">
                    <div class="dashboard-title">üìâ Sa√≠das</div>
                    <div class="dashboard-value saidas" id="totalSaidas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Gastos do per√≠odo</div>
                </div>
                <div class="dashboard-card">
                    <div class="dashboard-title">üìä Saldo</div>
                    <div class="dashboard-value saldo" id="saldoTotal">R$ 0,00</div>
                    <div class="dashboard-subtitle">Resultado l√≠quido</div>
                </div>
                <div class="dashboard-card dividas">
                    <div class="dashboard-title">ü§ù D√≠vidas</div>
                    <div class="dashboard-value dividas" id="totalDividas">R$ 0,00</div>
                    <div class="dashboard-subtitle">Valores em aberto</div>
                </div>
            </div>

            <!-- ADVANCED DASHBOARD -->
            <div class="dashboard-advanced">
                <div class="dashboard-card metas">
                    <div class="dashboard-title">üéØ Metas do M√™s</div>
                    <div class="dashboard-value" id="metaProgress">0%</div>
                    <div class="dashboard-subtitle" id="metaSubtitle">Sem metas definidas</div>
                </div>
                <div class="dashboard-card comparativo">
                    <div class="dashboard-title">üìà Comparativo (M√™s)</div>
                    <div class="dashboard-value" id="comparativoValue">-</div>
                    <div class="dashboard-subtitle" id="comparativoSubtitle">M√™s anterior sem dados</div>
                </div>
            </div>

            <!-- CARD DASHBOARD -->
            <div class="section" id="cardDashboardSection">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="section-title mb-0">üí≥ Meus Cart√µes</h2>
                    <button class="btn btn-secondary" onclick="app.openCardModal()">Gerenciar Cart√µes</button>
                </div>
                <div class="dashboard" id="cardDashboard"></div>
            </div>

            <!-- LOANS SECTION -->
            <div class="section" id="loansSection">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="section-title mb-0">üè¶ Meus Empr√©stimos</h2>
                    <button class="btn btn-secondary" onclick="app.openLoanModal()">Adicionar Empr√©stimo</button>
                </div>
                <div id="loanList">
                    <p class="text-muted" style="text-align: center; padding: 20px 0;">Nenhum empr√©stimo registrado.</p>
                </div>
            </div>

            <!-- FORM SECTION -->
            <div class="section">
                <h2 class="section-title">‚ûï Nova Transa√ß√£o</h2>
                <form id="transactionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="data">üìÖ Data</label>
                            <input type="date" id="data" name="data" required>
                            <div class="error-message" id="dataError">Data inv√°lida</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="tipo">üìä Tipo</label>
                            <select id="tipo" name="tipo" required>
                                <option value="">Selecione...</option>
                                <option value="Entrada">üí∞ Entrada</option>
                                <option value="Sa√≠da">üìâ Sa√≠da</option>
                            </select>
                            <div class="error-message" id="tipoError">Tipo √© obrigat√≥rio</div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="descricao">üìù Descri√ß√£o</label>
                            <input type="text" id="descricao" name="descricao" placeholder="Ex: Sal√°rio, Compras no mercado..." required>
                            <div class="error-message" id="descricaoError">Descri√ß√£o √© obrigat√≥ria</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="categoria">üè∑Ô∏è Categoria</label>
                            <div class="custom-select-container">
                                <select id="categoria" name="categoria" required>
                                    <option value="">Selecione...</option>
                                </select>
                                <button type="button" class="add-option-btn" onclick="app.addCustomOption('categoria')">+</button>
                            </div>
                            <div class="error-message" id="categoriaError">Categoria √© obrigat√≥ria</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="banco">üè¶ Banco/Conta</label>
                            <div class="custom-select-container">
                                <select id="banco" name="banco" required>
                                    <option value="">Selecione...</option>
                                </select>
                                <button type="button" class="add-option-btn" onclick="app.addCustomOption('banco')">+</button>
                            </div>
                            <div class="error-message" id="bancoError">Banco √© obrigat√≥rio</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="valor">üíµ Valor Total</label>
                            <input type="number" id="valor" name="valor" step="0.01" min="0.01" placeholder="0,00" required>
                            <div class="error-message" id="valorError">Valor deve ser maior que zero</div>
                        </div>
                        
                        <div class="form-group hidden" id="valorPagoGroup">
                            <label for="valorPago">üí≥ Valor Pago por Mim</label>
                            <input type="number" id="valorPago" name="valorPago" step="0.01" min="0" placeholder="0,00">
                            <div class="error-message" id="valorPagoError">Valor pago inv√°lido</div>
                        </div>
                        
                        <div class="form-group" id="gastoParaGroup">
                            <label for="gastoPara">üë§ Gasto para (opcional)</label>
                            <select id="gastoPara" name="gastoPara">
                                <option value="">Gasto pessoal</option>
                            </select>
                            <div style="margin-top: 5px;">
                                <button type="button" class="btn btn-secondary btn-small" onclick="app.addPersonFromGasto()">
                                    ‚ûï Nova Pessoa
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="formaPagamento">üí≥ Forma de Pagamento</label>
                            <select id="formaPagamento" name="formaPagamento" required>
                                <option value="">Selecione...</option>
                                <option value="PIX">üîÑ PIX</option>
                                <option value="D√©bito">üí≥ D√©bito</option>
                                <option value="Cr√©dito">üíé Cr√©dito</option>
                                <option value="Dinheiro">üíµ Dinheiro</option>
                                <option value="TED/DOC">üè¶ TED/DOC</option>
                            </select>
                            <div class="error-message" id="formaPagamentoError">Forma de pagamento √© obrigat√≥ria</div>
                        </div>

                        <div class="form-group hidden" id="cardSelectGroup">
                            <label for="cardSelect">üí≥ Cart√£o de Cr√©dito</label>
                            <select id="cardSelect" name="cardSelect">
                                <option value="">Selecione o cart√£o...</option>
                            </select>
                            <div class="error-message" id="cardSelectError">Selecione um cart√£o</div>
                        </div>

                        <div class="form-group hidden" id="installmentsGroup">
                            <label for="installments">N¬∫ de Parcelas</label>
                            <input type="number" id="installments" name="installments" min="1" value="1">
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="observacao">üìÑ Observa√ß√µes</label>
                            <textarea id="observacao" name="observacao" rows="2" placeholder="Informa√ß√µes adicionais..."></textarea>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="compartilhada" name="compartilhada">
                        <label for="compartilhada">ü§ù Dividir este gasto com outras pessoas</label>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary">
                            ‚ûï Adicionar Transa√ß√£o
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="app.clearForm()">
                            üîÑ Limpar
                        </button>
                    </div>
                </form>
            </div>

            <!-- TRANSACTIONS TABLE -->
            <div class="transactions-section">
                <div class="table-header">
                    <h2 class="section-title">üìã Hist√≥rico de Transa√ß√µes</h2>
                    
                    <div class="search-container">
                        <span class="search-icon">üîç</span>
                        <input type="text" class="search-input" id="searchInput" placeholder="Buscar por descri√ß√£o, valor ou observa√ß√µes...">
                    </div>
                    
                    <div class="table-filters">
                        <div class="filter-group">
                            <label>Tipo:</label>
                            <select id="filterTipo">
                                <option value="">Todos</option>
                                <option value="Entrada">Entradas</option>
                                <option value="Sa√≠da">Sa√≠das</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Categoria:</label>
                            <select id="filterCategoria">
                                <option value="">Todas</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Banco:</label>
                            <select id="filterBanco">
                                <option value="">Todos</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label>Status:</label>
                            <select id="filterStatus">
                                <option value="">Todos</option>
                                <option value="compartilhada">Compartilhadas</option>
                                <option value="individual">Individuais</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="data">üìÖ Data</th>
                                <th class="sortable" data-sort="descricao">üìù Descri√ß√£o</th>
                                <th class="sortable" data-sort="tipo">üìä Tipo</th>
                                <th class="sortable" data-sort="valor">üíµ Valor</th>
                                <th class="sortable" data-sort="valorPago">üí≥ Pago</th>
                                <th class="sortable" data-sort="categoria">üè∑Ô∏è Categoria</th>
                                <th class="sortable" data-sort="banco">üè¶ Banco</th>
                                <th>ü§ù Status</th>
                                <th>‚öôÔ∏è A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsBody">
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                                    Nenhuma transa√ß√£o encontrada
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- Pagina√ß√£o ser√° inserida dinamicamente -->
                </div>
            </div>

            <!-- ANALYSIS SECTION -->
            <div class="section">
                <h2 class="section-title">üìä An√°lises do M√™s</h2>
                <div class="analysis-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                    <div id="cardSummarySection">
                        <h3 class="section-title">Resumo dos Cart√µes</h3>
                        <!-- Card summary will be injected here -->
                    </div>
                    <div id="categoryChartSection">
                        <h3 class="section-title">Gastos por Categoria</h3>
                        <!-- Pie chart will be injected here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel">
            <!-- DEBT PANEL -->
            <div class="debt-panel">
                <div class="debt-panel-header" style="display: flex; justify-content: space-between; align-items: center;">
                    <span>ü§ù D√≠vidas e Contas</span>
                    <button class="btn btn-small btn-primary" style="background-color: white; color: var(--warning);" onclick="app.openDebtManagementModal()">Adicionar</button>
                </div>
                <div id="accountsReceivableSection">
                    <h4 style="padding: 10px 15px; background: var(--bg-secondary);">Contas a Receber</h4>
                    <div class="debt-list" id="receivableList">
                        <p class="text-muted" style="padding: 15px; text-align: center;">Ningu√©m te deve.</p>
                    </div>
                </div>
                <div id="accountsPayableSection">
                    <h4 style="padding: 10px 15px; background: var(--bg-secondary);">Contas a Pagar</h4>
                    <div class="debt-list" id="payableList">
                        <p class="text-muted" style="padding: 15px; text-align: center;">Voc√™ n√£o deve a ningu√©m.</p>
                    </div>
                </div>
            </div>

            <!-- QUICK STATS -->
            <div class="section">
                <h3 class="section-title">üìä Estat√≠sticas R√°pidas</h3>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div style="display: flex; justify-content: space-between;">
                        <span>Transa√ß√µes este m√™s:</span>
                        <strong id="statsTransacoes">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Gastos compartilhados:</span>
                        <strong id="statsCompartilhados">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Pessoas envolvidas:</span>
                        <strong id="statsPessoas">0</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Maior gasto:</span>
                        <strong id="statsMaiorGasto">R$ 0,00</strong>
                    </div>
                </div>
            </div>

            <!-- GASTOS POR PESSOA -->
            <div class="section">
                <h3 class="section-title">üë§ Gastos por Pessoa</h3>
                <div id="gastosPorPessoa">
                    <p class="text-muted">Nenhum gasto para outras pessoas</p>
                </div>
            </div>

            <!-- GOALS/METAS SYSTEM -->
            <div class="section">
                <h3 class="section-title">üéØ Sistema de Metas</h3>
                
                <!-- Goals Form -->
                <div class="goals-form-container" style="margin-bottom: 20px;">
                    <form id="goalsForm" class="form-inline">
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaNome">Nome da Meta</label>
                            <input type="text" id="metaNome" placeholder="Ex: Emerg√™ncia, Viagem" required>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaBanco">Banco/Conta</label>
                            <select id="metaBanco" required>
                                <option value="">Selecione o banco</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaValorDesejado">Valor Desejado</label>
                            <input type="number" id="metaValorDesejado" step="0.01" min="0" required>
                        </div>
                        
                        <div class="form-group" style="margin-right: 15px;">
                            <label for="metaValorAtual">Valor Atual</label>
                            <input type="number" id="metaValorAtual" step="0.01" min="0" value="0">
                        </div>
                        
                        <button type="submit" class="btn btn-primary">‚ûï Adicionar Meta</button>
                    </form>
                </div>
                
                <!-- Active Goals List -->
                <div id="activeGoals">
                    <p class="text-muted">Nenhuma meta definida</p>
                </div>
            </div>

            <!-- RECENT PEOPLE -->
            <div class="section">
                <h3 class="section-title">üë• Pessoas Recentes</h3>
                <div id="recentPeople">
                    <p class="text-muted">Nenhuma pessoa cadastrada</p>
                </div>
            </div>
        </div>
    </main>

    <!-- MODALS -->
    
    <!-- SPLIT MODAL -->
    <div class="modal-overlay" id="splitModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">ü§ù Dividir Gasto</h3>
                <button class="modal-close" onclick="app.closeSplitModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="split-type-selector">
                    <button type="button" class="split-type-btn active" data-type="igual">
                        üìä Divis√£o Igual
                    </button>
                    <button type="button" class="split-type-btn" data-type="percentual">
                        üìà Por Percentual
                    </button>
                    <button type="button" class="split-type-btn" data-type="fixo">
                        üí∞ Valores Fixos
                    </button>
                </div>

                <div class="form-group">
                    <label for="splitPersonSelect">üë• Adicionar Pessoa:</label>
                    <div style="display: flex; gap: 10px;">
                        <select id="splitPersonSelect" style="flex: 1;"></select>
                        <button type="button" class="btn btn-secondary" onclick="app.addPersonToSplit()">
                            ‚ûï Adicionar
                        </button>
                    </div>
                </div>

                <div class="people-list" id="splitPeopleList">
                    <!-- Pessoas ser√£o adicionadas dinamicamente -->
                </div>

                <div class="form-group">
                    <div style="display: flex; justify-content: space-between; font-weight: 600;">
                        <span>Total a dividir:</span>
                        <span id="splitTotalValue">R$ 0,00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeSplitModal()">
                    ‚ùå Cancelar
                </button>
                <button class="btn btn-primary" onclick="app.saveSplitTransaction()">
                    ‚úÖ Salvar Divis√£o
                </button>
            </div>
        </div>
    </div>

    <!-- DEBT DETAIL MODAL -->
    <div class="modal-overlay" id="debtModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="debtModalTitle">üë§ Detalhes da D√≠vida</h3>
                <button class="modal-close" onclick="app.closeDebtModal()">&times;</button>
            </div>
            <div class="modal-body" id="debtModalBody">
                <!-- Conte√∫do ser√° carregado dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeDebtModal()">
                    ‚ùå Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- CARD MANAGEMENT MODAL -->
    <div class="modal-overlay" id="cardModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="cardModalTitle">üí≥ Gerenciar Cart√µes</h3>
                <button class="modal-close" onclick="app.closeCardModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cardSummaryInModal" style="margin-bottom: 20px;"></div>
                <form id="cardForm">
                    <input type="hidden" id="cardId">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="cardName">Nome do Cart√£o</label>
                            <input type="text" id="cardName" placeholder="Ex: Nubank Ultravioleta" required>
                        </div>
                        <div class="form-group">
                            <label for="cardLimit">Limite Total (R$)</label>
                            <input type="number" id="cardLimit" step="0.01" min="0" placeholder="5000,00" required>
                        </div>
                        <div class="form-group">
                            <label for="cardBrand">Bandeira</label>
                            <select id="cardBrand" required>
                                <option value="Mastercard">Mastercard</option>
                                <option value="Visa">Visa</option>
                                <option value="Elo">Elo</option>
                                <option value="American Express">American Express</option>
                                <option value="Hipercard">Hipercard</option>
                                <option value="Outra">Outra</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cardClosingDay">Dia do Fechamento</label>
                            <input type="number" id="cardClosingDay" min="1" max="31" placeholder="Ex: 25" required>
                        </div>
                        <div class="form-group">
                            <label for="cardDueDay">Dia do Vencimento</label>
                            <input type="number" id="cardDueDay" min="1" max="31" placeholder="Ex: 10" required>
                        </div>
                        <div class="form-group">
                            <label for="cardColor">Cor do Cart√£o</label>
                            <input type="color" id="cardColor" value="#8A2BE2" style="padding: 5px; height: 45px;">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeCardModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Cart√£o</button>
                    </div>
                </form>
                <hr class="mb-2 mt-2">
                <h4 class="section-title">Cart√µes Cadastrados</h4>
                <div id="cardList"></div>
            </div>
        </div>
    </div>

    <!-- LOAN MANAGEMENT MODAL -->
    <div class="modal-overlay" id="loanModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="loanModalTitle">Adicionar Empr√©stimo</h3>
                <button class="modal-close" onclick="app.closeLoanModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loanForm">
                    <input type="hidden" id="loanId">
                    <div class="form-grid">
                        <div class="form-group full-width">
                            <label for="loanDescription">Descri√ß√£o do Empr√©stimo</label>
                            <input type="text" id="loanDescription" placeholder="Ex: Financiamento Carro, Empr√©stimo Pessoal" required>
                        </div>
                        <div class="form-group">
                            <label for="loanTotalAmount">Valor Total (R$)</label>
                            <input type="number" id="loanTotalAmount" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="loanAmountPaid">Valor j√° Pago (R$)</label>
                            <input type="number" id="loanAmountPaid" step="0.01" min="0" value="0" required>
                        </div>
                        <div class="form-group">
                            <label for="loanInstallmentAmount">Valor da Parcela (R$)</label>
                            <input type="number" id="loanInstallmentAmount" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="loanNextDueDate">Pr√≥ximo Vencimento</label>
                            <input type="date" id="loanNextDueDate">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeLoanModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Empr√©stimo</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- DEBT MANAGEMENT MODAL -->
    <div class="modal-overlay" id="debtManagementModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Gerenciar D√≠vida</h3>
                <button class="modal-close" onclick="app.closeDebtManagementModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="debtForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="debtType">Tipo de D√≠vida</label>
                            <select id="debtType" required>
                                <option value="aPagar">Eu devo (Conta a Pagar)</option>
                                <option value="aReceber">Me devem (Conta a Receber)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="debtPerson">Pessoa</label>
                            <select id="debtPerson" required></select>
                        </div>
                        <div class="form-group full-width">
                            <label for="debtDescription">Descri√ß√£o</label>
                            <input type="text" id="debtDescription" placeholder="Ex: Aluguel, Empr√©stimo amigo" required>
                        </div>
                        <div class="form-group">
                            <label for="debtAmount">Valor (R$)</label>
                            <input type="number" id="debtAmount" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="debtDueDate">Data de Vencimento</label>
                            <input type="date" id="debtDueDate" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" onclick="app.closeDebtManagementModal()">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar D√≠vida</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- INVOICE DETAIL MODAL -->
    <div class="modal-overlay" id="invoiceDetailModal">
        <div class="modal" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title" id="invoiceDetailTitle">Detalhes da Fatura</h3>
                <button class="modal-close" onclick="app.closeInvoiceDetailModal()">&times;</button>
            </div>
            <div class="modal-body" id="invoiceDetailBody">
                <!-- Content will be loaded dynamically -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="app.closeInvoiceDetailModal()">Fechar</button>
                <button class="btn btn-success" id="payInvoiceBtn">Pagar Fatura</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">‚öôÔ∏è Configura√ß√µes</h3>
                <button class="modal-close" onclick="app.closeSettings()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>üè∑Ô∏è Categorias Personalizadas:</label>
                    <div id="customCategories"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addCustomCategory()">
                        ‚ûï Nova Categoria
                    </button>
                </div>

                <div class="form-group">
                    <label>üè¶ Bancos/Contas Personalizadas:</label>
                    <div id="customBanks"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addCustomBank()">
                        ‚ûï Novo Banco
                    </button>
                </div>

                <div class="form-group">
                    <label>üë• Pessoas Cadastradas:</label>
                    <div id="peopleList"></div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="app.addPerson()">
                        ‚ûï Nova Pessoa
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="app.clearAllData()">
                    üóëÔ∏è Limpar Tudo
                </button>
                <button class="btn btn-secondary" onclick="app.closeSettings()">
                    ‚ùå Fechar
                </button>
            </div>
        </div>
    </div>

    <script src="script.js?v=202508"></script>
</body>
</html>